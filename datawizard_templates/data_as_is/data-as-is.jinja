Instance: {{instance_name}}
InstanceOf: Bundle
Usage: #example
{% if description -%}
Description: "Agen 10mg Tablet. Estonia. Simple example of one full product as a bundle. Packages, PCIDs, differ by material."
{%- endif%}
* type = #transaction

* entry[0].resource = Agen-10mg-Tablet-EE-MPD
* entry[=].request.method = #PUT
* entry[=].request.url = "MedicinalProductDefinition/Agen-10mg-Tablet-EE-MPD"
* entry[=].fullUrl = "https://hl7-eu.github.io/unicom-ig/branches/mpd-r4b/MedicinalProductDefinition/Agen-10mg-Tablet-EE-MPD"

* entry[+].resource = Agen-10mg-Tablet-EE-RA
* entry[=].request.method = #PUT
* entry[=].request.url = "RegulatedAuthorization/Agen-10mg-Tablet-EE-RA"
* entry[=].fullUrl = "https://hl7-eu.github.io/unicom-ig/branches/mpd-r4b/RegulatedAuthorization/Agen-10mg-Tablet-EE-RA"

* entry[+].resource = LOC-100002580-Zentiva
* entry[=].request.method = #PUT
* entry[=].request.url = "Organization/LOC-100002580-Zentiva"
* entry[=].fullUrl = "https://hl7-eu.github.io/unicom-ig/branches/mpd-r4b/Organization/LOC-100002580-Zentiva"

* entry[+].resource = Agen-10mg-Tablet-EE-APD
* entry[=].request.method = #PUT
* entry[=].request.url = "AdministrableProductDefinition/Agen-10mg-Tablet-EE-APD"
* entry[=].fullUrl = "https://hl7-eu.github.io/unicom-ig/branches/mpd-r4b/AdministrableProductDefinition/Agen-10mg-Tablet-EE-APD"

* entry[+].resource = Agen-10mg-Tablet-EE-MID
* entry[=].request.method = #PUT
* entry[=].request.url = "ManufacturedItemDefinition/Agen-10mg-Tablet-EE-MID"
* entry[=].fullUrl = "https://hl7-eu.github.io/unicom-ig/branches/mpd-r4b/ManufacturedItemDefinition/Agen-10mg-Tablet-EE-MID"

* entry[+].resource = Agen-10mg-Tablet-EE-I
* entry[=].request.method = #PUT
* entry[=].request.url = "Ingredient/Agen-10mg-Tablet-EE-I"
* entry[=].fullUrl = "https://hl7-eu.github.io/unicom-ig/branches/mpd-r4b/Ingredient/Agen-10mg-Tablet-EE-I"

* entry[+].resource = Agen-10mg-Tablet-EE-PPD-1109900-A
* entry[=].request.method = #PUT
* entry[=].request.url = "PackagedProductDefinition/Agen-10mg-Tablet-EE-PPD-1109900-A"
* entry[=].fullUrl = "https://hl7-eu.github.io/unicom-ig/branches/mpd-r4b/PackagedProductDefinition/Agen-10mg-Tablet-EE-PPD-1109900-A"

* entry[+].resource = Agen-10mg-Tablet-EE-PPD-1109900-B
* entry[=].request.method = #PUT
* entry[=].request.url = "PackagedProductDefinition/Agen-10mg-Tablet-EE-PPD-1109900-B"
* entry[=].fullUrl = "https://hl7-eu.github.io/unicom-ig/branches/mpd-r4b/PackagedProductDefinition/Agen-10mg-Tablet-EE-PPD-1109900-B"

{% with usage=inline -%}
{% include components PPL_MedicinalProductDefinition.jinja %}

{% include components PPL_RegulatedAuthorization.jinja %}

{% include components PPL_AdministrableProductDefinition.jinja %}

{% include components PPL_ManufacturedItemDefinition.jinja %}
{%- endwith %}


Instance: {{full_name}}-I
InstanceOf: PPLIngredient
Usage: #inline
* status = #active
* for[0] = Reference({{full_name}}-MPD)
* for[+] = Reference({{full_name}}-MID)
* for[+] = Reference({{full_name}}-APD)
* role = $100000072050#100000072072 "Active"
* substance.code.concept = $sms#{{substance.code}} "{{substance.display}}"
{% if presentation_ratio -%}
* substance.strength.presentationRatio.numerator = {{presentation_ratio.numerator.value}} $100000110633#{{presentation_ratio.numerator.code}} "{{presentation_ratio.numerator.display}}"
* substance.strength.presentationRatio.denominator = {{presentation_ratio.denominator.value}} $200000000014#{{presentation_ratio.denominator.value}} "{{presentation_ratio.denominator.display}}"
{%- endif %}
{% if reference_strength -%}
* substance.strength.referenceStrength.substance.concept = $sms#{{substance.code}} "{{substance.display}}"
* substance.strength.referenceStrength.strengthRatio.numerator = {{reference_strength.numerator.value}} $100000110633#{{reference_strength.numerator.code}} "{{reference_strength.numerator.display}}"
* substance.strength.referenceStrength.strengthRatio.denominator = {{reference_strength.denominator.value}} $100000110633#{{reference_strength.denominator.code}} "{{reference_strength.denominator.display}}"
{%- endif %}


Instance: {{full_name}}-PPD-1109900-A
InstanceOf: PPLPackagedProductDefinition
Usage: #inline

* identifier[pcid].value = "EE-100002580-15548-1109900a" //pcId ?
* packageFor = Reference({{full_name}}-MPD)
* containedItemQuantity = 30 $200000000014#{{unit_of_presentation.code}} "{{unit_of_presentation.display}}"
//  * description = "Tabletid on pakendatud PVC/PVDC/Al blistritesse (valged) või PVC/Al blistritesse (valged)."
//  * extension.url = "http://ema.europa.eu/fhir/extension/language"
//  * extension.valueCoding = $100000072057#100000072172 "Estonian"
* marketingStatus.country = $100000000002#{{country.code}} "{{country.display}}"
* marketingStatus.status = $100000072052#100000072083 "Marketed" // status?
* packaging.type = $100000073346#100000073498 "Box"
* packaging.quantity = 1
* packaging.material = $200000003199#200000003529 "Cardboard"
* packaging.packaging.type = $100000073346#100000073496 "Blister"
* packaging.packaging.quantity = 1 // TO DO: should not be mandatory maybe
* packaging.packaging.material[0] = $200000003199#200000003222 "PolyVinyl Chloride"
* packaging.packaging.material[+] = $200000003199#200000003225 "PolyVinylidene Chloride"
* packaging.packaging.material[+] = $200000003199#200000003200 "Aluminium"
* packaging.packaging.containedItem.item.reference = Reference(Agen-10mg-Tablet-EE-MID)
* packaging.packaging.containedItem.amount.value = 30


Instance: Agen-10mg-Tablet-EE-PPD-1109900-B
InstanceOf: PPLPackagedProductDefinition
Usage: #inline
* identifier[pcid].value = "EE-100002580-15548-1109900b"
* packageFor = Reference(Agen-10mg-Tablet-EE-MPD)
* containedItemQuantity = 30 $200000000014#200000002152 "Tablet"
* description = "Tabletid on pakendatud PVC/PVDC/Al blistritesse (valged) või PVC/Al blistritesse (valged)."
//  * extension.url = "http://ema.europa.eu/fhir/extension/language"
//  * extension.valueCoding = $100000072057#100000072172 "Estonian"
* marketingStatus.country = $100000000002#{{country.code}} "{{country.display}}"
* marketingStatus.status = $100000072052#100000072083 "Marketed"
* packaging.type = $100000073346#100000073498 "Box"
* packaging.quantity = 1
* packaging.material = $200000003199#200000003529 "Cardboard"
* packaging.packaging.type = $100000073346#100000073496 "Blister"
* packaging.packaging.quantity = 1 // TO DO: should not be mandatory maybe
* packaging.packaging.material[0] = $200000003199#200000003222 "PolyVinyl Chloride"
* packaging.packaging.material[+] = $200000003199#200000003200 "Aluminium"
* packaging.packaging.containedItem.item.reference = Reference(Agen-10mg-Tablet-EE-MID)
* packaging.packaging.containedItem.amount.value = 30